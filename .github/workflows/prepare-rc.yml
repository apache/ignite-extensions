#
# Licensed to the Apache Software Foundation (ASF) under one
# or more contributor license agreements.  See the NOTICE file
# distributed with this work for additional information
# regarding copyright ownership.  The ASF licenses this file
# to you under the Apache License, Version 2.0 (the
# "License"); you may not use this file except in compliance
# with the License.  You may obtain a copy of the License at
#
#   http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing,
# software distributed under the License is distributed on an
# "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
# KIND, either express or implied.  See the License for the
# specific language governing permissions and limitations
# under the License.
#
#################################################################################
#
# You can test this workflow locally using the `act` command.
# Please, follow the command installation guide: https://github.com/nektos/act
#
#
# Execute the command below from the command line to run workflow:
#
# admin@workbook ignite-extensions % act --job prepare --eventpath release.prepare.workflow.event \
#    -s GITHUB_TOKEN=[your_github_token_for_the_fork_repo]
#
# Use the following json-file as an event to trigger the workflow:
#
#  admin@workbook ignite-extensions % cat release.prepare.workflow.event
#  {
#    "action": "workflow_dispatch",
#    "inputs": {
#      "extension": "ignite-zookeeper-ip-finder-ext-1.0.0",
#    }
#  }
#
# The act command executes the workflow in the docker container. Some of them may require
# the manual maven installation. Use the step below to install Maven 3.6.3 version into container.
#
# - name: Download Maven
#   run: |
#     curl -sL https://www-eu.apache.org/dist/maven/maven-3/3.6.3/binaries/apache-maven-3.6.3-bin.zip -o maven.zip
#     apt-get update
#     apt-get -y install unzip
#     unzip -d /usr/share maven.zip
#     rm maven.zip
#     ln -s /usr/share/apache-maven-3.6.3/bin/mvn /usr/bin/mvn
#     echo "M2_HOME=/usr/share/apache-maven-3.6.3" | tee -a /etc/environment
#
#################################################################################

name: "Release Prepare"

on:
  workflow_dispatch:
    inputs:
      extension:
        description: 'The Ignite Extension to release (e.g. ignite-aws-ext-1.0.0)'
        required: true

env:
  SERVER_URL: 'https://dist.apache.org/repos/dist/dev/ignite/ignite-extensions/'

jobs:
  prepare:
    runs-on: ubuntu-18.04
    steps:
      - name: Show environment v1
        run: env | grep ^GITHUB
      - name: Show ref v1
        run: echo "===============> Version from $GITHUB_REF"
